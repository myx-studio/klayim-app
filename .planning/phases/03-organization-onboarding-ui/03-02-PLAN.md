---
phase: 03-organization-onboarding-ui
plan: 02
type: execute
wave: 2
depends_on: [03-01]
files_modified:
  - apps/web/src/components/pages/onboarding/connect-hris/index.tsx
  - apps/web/src/components/pages/onboarding/connect-calendar/index.tsx
  - apps/web/src/components/pages/onboarding/connect-task/index.tsx
  - apps/web/src/components/pages/onboarding/configure-governance/index.tsx
  - apps/web/src/components/pages/onboarding/onboarding-success/index.tsx
  - apps/web/src/components/onboarding/upload-csv-dialog.tsx
  - apps/web/src/app/onboarding/connect-task/page.tsx
  - apps/web/src/app/onboarding/onboarding-success/page.tsx
autonomous: true
requirements: [OONB-01, OONB-02, OONB-03, OONB-04]

must_haves:
  truths:
    - "User sees Connect HRIS page with provider cards for BambooHR, Rippling, Gusto"
    - "User sees fallback options (Upload CSV, Contact Support) on HRIS page"
    - "User sees Connect Calendar page with Google Workspace and Microsoft 365 cards"
    - "User sees Connect Task page with Asana, ClickUp, Linear cards"
    - "User sees Configure Governance page with form fields for thresholds"
    - "User can navigate forward and backward through all wizard steps"
    - "User can skip optional steps (HRIS, Calendar, Task) and proceed"
    - "User sees onboarding success page with what happens next"
    - "User can open Upload CSV dialog from HRIS page"
  artifacts:
    - path: "apps/web/src/components/pages/onboarding/connect-hris/index.tsx"
      provides: "Connect HRIS page with provider cards and fallback"
      min_lines: 80
    - path: "apps/web/src/components/pages/onboarding/connect-calendar/index.tsx"
      provides: "Connect Calendar page with Google and Microsoft cards"
      min_lines: 60
    - path: "apps/web/src/components/pages/onboarding/connect-task/index.tsx"
      provides: "Connect Task page with Asana, ClickUp, Linear cards"
      min_lines: 60
    - path: "apps/web/src/components/pages/onboarding/configure-governance/index.tsx"
      provides: "Configure Governance page with form fields"
      min_lines: 100
    - path: "apps/web/src/components/pages/onboarding/onboarding-success/index.tsx"
      provides: "Onboarding success page with what happens next"
      min_lines: 50
    - path: "apps/web/src/components/onboarding/upload-csv-dialog.tsx"
      provides: "Upload CSV dialog with drag-drop and template download"
      min_lines: 80
  key_links:
    - from: "apps/web/src/components/pages/onboarding/connect-hris/index.tsx"
      to: "apps/web/src/components/onboarding/org-onboarding-layout.tsx"
      via: "OrgOnboardingLayout wrapper"
      pattern: "import.*OrgOnboardingLayout"
    - from: "apps/web/src/components/pages/onboarding/connect-hris/index.tsx"
      to: "apps/web/src/components/onboarding/provider-card.tsx"
      via: "ProviderCard component"
      pattern: "import.*ProviderCard"
    - from: "apps/web/src/components/pages/onboarding/configure-governance/index.tsx"
      to: "apps/web/src/components/ui/input.tsx"
      via: "Form input fields"
      pattern: "import.*Input.*from.*ui/input"
---

<objective>
Implement all organization onboarding pages using the foundation components from Plan 01.

Purpose: Complete the wizard UI flow that guides users through integration setup (HRIS, Calendar, Task, Governance) and shows success page after completion.

Output: All 5 onboarding pages (Connect HRIS, Connect Calendar, Connect Task, Configure Governance, Onboarding Success) plus Upload CSV dialog.
</objective>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/phase-03/UI-REFERENCE.md
@.planning/phases/phase-03/03-01-SUMMARY.md
@apps/web/src/components/pages/onboarding/account-details/index.tsx
@apps/web/src/components/ui/dialog.tsx
@apps/web/src/components/ui/field.tsx
@apps/web/src/components/ui/select.tsx
@apps/web/src/components/ui/checkbox.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Implement Connect HRIS and Upload CSV Dialog</name>
  <files>
    apps/web/src/components/pages/onboarding/connect-hris/index.tsx
    apps/web/src/components/onboarding/upload-csv-dialog.tsx
  </files>
  <action>
Implement the Connect HRIS page and Upload CSV dialog.

**apps/web/src/components/pages/onboarding/connect-hris/index.tsx:**
Replace the existing placeholder with full implementation:
- Use OrgOnboardingLayout wrapper with title="Connect HRIS", description="Import employee data and rates from your HR system", currentStep=0
- Add onBack handler that navigates to /onboarding/overview
- Provider cards grid (3 columns on md+, 1 on mobile):
  - BambooHR: description="Sync employee data and hourly rates using BambooHR"
  - Rippling: description="Sync employee data and hourly rates using Rippling"
  - Gusto: description="Sync employee data and hourly rates using Gusto"
- For icons, use placeholder divs with provider initials or simple icons (actual logos will be added later)
- onConnect handlers: show toast "BambooHR integration coming soon" (use sonner toast)
- Fallback section after provider cards:
  - Text: "Don't see your HRIS?"
  - Two buttons in row: "Upload CSV" (outline, opens dialog) | "Contact Support" (outline, mailto link)
- InfoAccordion: title="What we'll import", items (all positive):
  - "Employee names and emails"
  - "Roles and departments"
  - "Hourly rates (calculated from salaries)"
  - "Employment status (active, contractor)"
- Navigation: onSkip and onNext both navigate to /onboarding/connect-calendar

**apps/web/src/components/onboarding/upload-csv-dialog.tsx:**
Create Upload CSV dialog component:
- Props: `open: boolean`, `onOpenChange: (open: boolean) => void`
- Use Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription
- Sub-stepper at top: Upload -> Validate -> Confirm (just visual, no functionality yet)
- Drag & drop zone:
  - Dashed border container
  - Upload icon (Upload from lucide-react)
  - Text: "Drag and drop your CSV here" + "or browse files"
  - File info: "Supported: .csv - Max 5MB"
  - Hidden file input with accept=".csv"
  - onClick handler to trigger file input
- Required Columns section (use InfoAccordion or simple collapsible):
  - "Full Name"
  - "Email (company domain)"
  - "Hourly Rate or Annual Salary"
  - "Department"
  - "Role"
- "Download Template" button (outline, full width) - href to placeholder template URL
- Footer: "Skip for Now" button to close dialog
- Note: Actual upload functionality will be implemented in Phase 6
  </action>
  <verify>
- `npx tsc --noEmit` passes
- Connect HRIS page renders with 3 provider cards
- Fallback section shows Upload CSV and Contact Support buttons
- Upload CSV dialog opens when button clicked
- InfoAccordion expands to show import items
- Navigation works (back to overview, skip/next to calendar)
  </verify>
  <done>
Connect HRIS page displays provider cards, fallback options, and info accordion. Upload CSV dialog opens with drag-drop zone and template download.
  </done>
</task>

<task type="auto">
  <name>Task 2: Implement Connect Calendar and Connect Task Pages</name>
  <files>
    apps/web/src/components/pages/onboarding/connect-calendar/index.tsx
    apps/web/src/components/pages/onboarding/connect-task/index.tsx
    apps/web/src/app/onboarding/connect-task/page.tsx
  </files>
  <action>
Implement the Connect Calendar and Connect Task pages.

**apps/web/src/components/pages/onboarding/connect-calendar/index.tsx:**
Replace existing placeholder:
- Use OrgOnboardingLayout with title="Connect Calendars", description="Sync team meeting data from your calendar", currentStep=1
- Add onBack handler that navigates to /onboarding/connect-hris
- Provider cards grid (2 columns on md+):
  - Google Workspace: description="Sync calendars and check team availability in real time"
  - Microsoft 365: description="Sync calendars and check team availability in real time"
- onConnect handlers: show toast "Calendar integration coming soon"
- Two InfoAccordions:
  1. "What we'll track" (all positive):
     - "Meeting titles and durations"
     - "Attendee lists and responses"
     - "Recurring meeting patterns"
     - "Meeting room bookings"
  2. "What we don't track" (all negative):
     - "Meeting recordings or transcripts"
     - "Meeting content or discussions"
     - "Individual messages or chat"
- Navigation: onSkip and onNext both navigate to /onboarding/connect-task

**apps/web/src/components/pages/onboarding/connect-task/index.tsx:**
Create new page component:
- Use OrgOnboardingLayout with title="Connect Task Management", description="Sync tasks and projects to track work alongside meetings", currentStep=1 (same as calendar - part of step 2)
- Add onBack handler that navigates to /onboarding/connect-calendar
- Provider cards grid (3 columns on md+):
  - Asana: description="Sync tasks and projects to keep meetings aligned with work"
  - ClickUp: description="Sync tasks and projects to keep meetings aligned with work"
  - Linear: description="Sync tasks and projects to keep meetings aligned with work"
- onConnect handlers: show toast "Task integration coming soon"
- InfoAccordion: title="What we'll import" (all positive):
  - "Task creation and completion dates"
  - "Task updates and reassignments"
  - "Time to completion by task type"
  - "Tasks assigned to external contractors"
- Navigation: onSkip and onNext both navigate to /onboarding/configure-governance

**apps/web/src/app/onboarding/connect-task/page.tsx:**
Create new route page:
- Import and render ConnectTaskPage from components/pages/onboarding/connect-task
- Follow existing page pattern (see connect-calendar/page.tsx)
  </action>
  <verify>
- `npx tsc --noEmit` passes
- Connect Calendar page renders with 2 provider cards
- Connect Task page renders with 3 provider cards
- Both pages have working info accordions
- Navigation flows correctly: HRIS -> Calendar -> Task -> Governance
- /onboarding/connect-task route works
  </verify>
  <done>
Connect Calendar and Connect Task pages display provider cards with descriptions, info accordions, and proper navigation between steps.
  </done>
</task>

<task type="auto">
  <name>Task 3: Implement Configure Governance and Onboarding Success Pages</name>
  <files>
    apps/web/src/components/pages/onboarding/configure-governance/index.tsx
    apps/web/src/components/pages/onboarding/onboarding-success/index.tsx
    apps/web/src/app/onboarding/onboarding-success/page.tsx
  </files>
  <action>
Implement the Configure Governance form and Onboarding Success pages.

**apps/web/src/components/pages/onboarding/configure-governance/index.tsx:**
Replace existing placeholder with full form:
- Use OrgOnboardingLayout with title="Configure Governance", description="Set thresholds and rules for your organization", currentStep=2
- Add onBack handler that navigates to /onboarding/connect-task
- Set showSkip=false (governance is required step)
- Set nextLabel="Complete Setup"
- Form fields using FieldGroup, Field, FieldLabel, FieldDescription pattern:
  1. Meeting Cost Threshold:
     - Label: "Meeting Cost Threshold"
     - Description: "Meetings exceeding this cost will require manager approval"
     - Input with "$" prefix (use InputGroup with addon), type="number", placeholder="500"
     - Default value: 500
  2. Low ROI Threshold:
     - Label: "Low ROI Threshold"
     - Description: "Meetings with ROI below this will be flagged for review"
     - Input with "x" suffix, type="number", step="0.1", placeholder="1.0"
     - Default value: 1.0
  3. Approval Email:
     - Label: "Approval Email"
     - Description: "Who should receive approval requests?"
     - Input type="email", placeholder="Enter approval email here..."
  4. Dashboard Refresh:
     - Label: "Dashboard Refresh"
     - Description: "Auto-refresh every"
     - Select dropdown with options: 15 minutes, 30 minutes, 1 hour, 2 hours
     - Default: 30 minutes
  5. Pull to Refresh:
     - Checkbox with label "Enable pull-to-refresh"
     - Default: checked
- Use local state for form values (no API integration yet - Phase 8)
- onNext: navigate to /onboarding/onboarding-success
- Add Check icon to "Complete Setup" button

**apps/web/src/components/pages/onboarding/onboarding-success/index.tsx:**
Create onboarding success page:
- Do NOT use OrgOnboardingLayout (different layout per design)
- Layout structure:
  - Logo centered at top
  - Heading: "Welcome to Klayim, {userName}!" (get from useSession)
  - Subheading: "Let's get you set up in 3 quick steps" (crossed out or completion message)
  - Card with title "What happens next":
    - Bullet list with green check icons:
      - "Your dashboard will populate with data within 24 hours"
      - "Meeting costs are calculated automatically"
      - "High-cost meetings will route to you for approval"
      - "You'll receive weekly governance summaries"
  - "Go to Dashboard" button (full width, primary) - navigates to /dashboard
- Use Card component for the "what happens next" section

**apps/web/src/app/onboarding/onboarding-success/page.tsx:**
Create new route page:
- Import and render OnboardingSuccessPage from components/pages/onboarding/onboarding-success
  </action>
  <verify>
- `npx tsc --noEmit` passes
- Configure Governance page renders with all 5 form fields
- Form fields have proper labels, descriptions, and default values
- Complete Setup button has check icon
- Onboarding Success page shows welcome message and what happens next
- Navigation: Task -> Governance -> Success -> Dashboard
  </verify>
  <done>
Configure Governance page displays form with threshold settings. Onboarding Success page shows completion message with what happens next and dashboard navigation.
  </done>
</task>

</tasks>

<verification>
- All TypeScript compiles: `npx tsc --noEmit`
- Full wizard flow navigable: Overview -> HRIS -> Calendar -> Task -> Governance -> Success -> Dashboard
- All pages use consistent OrgOnboardingLayout (except success page)
- Provider cards display correctly on all integration pages
- Info accordions expand/collapse with correct items
- Configure Governance form shows all fields with proper styling
- Upload CSV dialog opens from HRIS page
- Back navigation works on all pages
- Skip works on optional steps (HRIS, Calendar, Task)
</verification>

<success_criteria>
1. User can see organization onboarding overview with 3-step wizard (OONB-01)
2. User can navigate forward and backward through wizard steps (OONB-02)
3. User can skip optional steps (HRIS, Calendar, Task) and proceed to next (OONB-03)
4. User sees completion page with "What happens next" after finishing setup (OONB-04)
- Connect HRIS page shows 3 providers + fallback options + info accordion
- Connect Calendar page shows 2 providers + 2 info accordions
- Connect Task page shows 3 providers + info accordion
- Configure Governance page shows complete form
- Upload CSV dialog accessible from HRIS page
- Onboarding Success page shows welcome and next steps
</success_criteria>

<output>
After completion, create `.planning/phases/phase-03/03-02-SUMMARY.md`
</output>
