---
phase: 03-organization-onboarding-ui
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/web/src/components/ui/sub-stepper.tsx
  - apps/web/src/components/onboarding/provider-card.tsx
  - apps/web/src/components/onboarding/info-accordion.tsx
  - apps/web/src/components/onboarding/org-onboarding-layout.tsx
  - apps/web/src/lib/org-onboarding.ts
autonomous: true
requirements: [OONB-01, OONB-02]

must_haves:
  truths:
    - "User sees sub-stepper showing current position in org onboarding flow"
    - "User sees provider cards with icon, name, description, and connect button"
    - "User can expand/collapse info accordions to see what data will be imported"
    - "User can navigate backward through wizard using back button"
  artifacts:
    - path: "apps/web/src/components/ui/sub-stepper.tsx"
      provides: "Sub-stepper component for org onboarding pages"
      exports: ["SubStepper", "SubStepperProps"]
    - path: "apps/web/src/components/onboarding/provider-card.tsx"
      provides: "Provider card component for integration selection"
      exports: ["ProviderCard", "ProviderCardProps"]
    - path: "apps/web/src/components/onboarding/info-accordion.tsx"
      provides: "Info accordion component with checklist items"
      exports: ["InfoAccordion", "InfoAccordionProps"]
    - path: "apps/web/src/components/onboarding/org-onboarding-layout.tsx"
      provides: "Shared layout wrapper for org onboarding pages"
      exports: ["OrgOnboardingLayout"]
    - path: "apps/web/src/lib/org-onboarding.ts"
      provides: "Org onboarding step definitions and helpers"
      exports: ["ORG_ONBOARDING_STEPS", "getOrgStepIndex", "getOrgStepState"]
  key_links:
    - from: "apps/web/src/components/onboarding/org-onboarding-layout.tsx"
      to: "apps/web/src/components/ui/sub-stepper.tsx"
      via: "SubStepper component import"
      pattern: "import.*SubStepper.*from.*sub-stepper"
    - from: "apps/web/src/components/onboarding/org-onboarding-layout.tsx"
      to: "apps/web/src/lib/org-onboarding.ts"
      via: "Step definitions import"
      pattern: "import.*ORG_ONBOARDING_STEPS.*from.*org-onboarding"
---

<objective>
Create foundation components for organization onboarding wizard UI.

Purpose: These shared components are used across all organization onboarding pages (Connect HRIS, Connect Calendar, Connect Task, Configure Governance). Building them first ensures consistent UI and reduces duplication.

Output: SubStepper component, ProviderCard component, InfoAccordion component, OrgOnboardingLayout wrapper, and step definitions.
</objective>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/phase-03/UI-REFERENCE.md
@apps/web/src/components/ui/stepper.tsx
@apps/web/src/components/ui/accordion.tsx
@apps/web/src/components/ui/card.tsx
@apps/web/src/components/ui/button.tsx
@apps/web/src/lib/onboarding.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Sub-Stepper Component and Step Definitions</name>
  <files>
    apps/web/src/components/ui/sub-stepper.tsx
    apps/web/src/lib/org-onboarding.ts
  </files>
  <action>
Create the sub-stepper component for organization onboarding pages. This is a simpler version of the main Stepper that shows 3 steps horizontally with states.

**apps/web/src/lib/org-onboarding.ts:**
- Define `ORG_ONBOARDING_STEPS` array with 3 steps:
  1. `{ id: "connect-hris", label: "Connect HRIS", href: "/onboarding/connect-hris" }`
  2. `{ id: "connect-calendars-task", label: "Connect Calendars & Task", href: "/onboarding/connect-calendar" }` (note: this step includes both calendar and task pages)
  3. `{ id: "configure-governance", label: "Configure Governance", href: "/onboarding/configure-governance" }`
- Create `getOrgStepIndex(pathname: string): number` - returns step index based on current path
  - `/onboarding/connect-hris` or `/onboarding/upload-csv` => 0
  - `/onboarding/connect-calendar` or `/onboarding/connect-task` => 1
  - `/onboarding/configure-governance` => 2
- Create `getOrgStepState(stepIndex: number, currentIndex: number): StepState` - returns "completed" | "active" | "pending"
- Export type `OrgOnboardingStepId`

**apps/web/src/components/ui/sub-stepper.tsx:**
- Create SubStepper component following the existing Stepper pattern (use CVA for variants)
- Props: `steps: SubStep[]`, `currentStep: number`, `className?: string`
- SubStep type: `{ id: string; label: string }`
- Display horizontally with connectors (use ChevronRight or dash line between steps)
- Step states (via CVA):
  - `completed`: Green checkmark icon in green circle, normal text
  - `active`: Gray dot icon in primary/10 circle, bold text
  - `pending`: Gray dot icon in muted circle, muted text
- No mobile view needed (keep simple unlike main Stepper)
- Use existing color tokens: `bg-emerald-100 text-emerald-600` for completed, `bg-primary/10 text-primary` for active, `bg-muted text-muted-foreground` for pending
  </action>
  <verify>
- `npx tsc --noEmit` passes
- SubStepper component renders 3 steps with correct states
- Step definitions match UI-REFERENCE.md
  </verify>
  <done>
SubStepper component shows 3 steps with completed/active/pending states, step definitions map paths to correct steps
  </done>
</task>

<task type="auto">
  <name>Task 2: Create ProviderCard and InfoAccordion Components</name>
  <files>
    apps/web/src/components/onboarding/provider-card.tsx
    apps/web/src/components/onboarding/info-accordion.tsx
  </files>
  <action>
Create the two main UI components used across all org onboarding pages.

**apps/web/src/components/onboarding/provider-card.tsx:**
- Create ProviderCard component for integration provider selection
- Props interface `ProviderCardProps`:
  - `icon: React.ReactNode` - provider logo/icon (allow flexibility for different providers)
  - `name: string` - provider name (e.g., "BambooHR")
  - `description: string` - brief description
  - `onConnect: () => void` - callback when Connect button clicked
  - `disabled?: boolean` - optional disabled state
  - `className?: string`
- Layout: Card with padding, icon top-left, name as title, description text, "Connect" button at bottom
- Use existing Card component as base
- Button should be full-width, dark variant (default)
- Maintain consistent sizing for grid layout (min-height for uniformity)

**apps/web/src/components/onboarding/info-accordion.tsx:**
- Create InfoAccordion component for expandable info sections
- Props interface `InfoAccordionProps`:
  - `title: string` - accordion header text (e.g., "What we'll import")
  - `items: InfoItem[]` - list of items to display
  - `defaultOpen?: boolean` - whether accordion starts expanded
  - `className?: string`
- InfoItem type: `{ text: string; positive?: boolean }` - positive items get green check, negative get red X
- Use existing Accordion, AccordionItem, AccordionTrigger, AccordionContent from ui/accordion
- Custom trigger styling: add HelpCircle icon (from lucide-react) before title text
- Content: render items as checklist with Check icon (green) for positive items, X icon (red) for negative items
- Use consistent spacing and text-sm sizing
  </action>
  <verify>
- `npx tsc --noEmit` passes
- ProviderCard renders with icon, name, description, and Connect button
- InfoAccordion expands/collapses and shows checklist items with correct icons
  </verify>
  <done>
ProviderCard shows provider info with connect action, InfoAccordion shows expandable checklist with positive/negative item indicators
  </done>
</task>

<task type="auto">
  <name>Task 3: Create OrgOnboardingLayout Wrapper</name>
  <files>
    apps/web/src/components/onboarding/org-onboarding-layout.tsx
  </files>
  <action>
Create shared layout wrapper that provides consistent structure for all org onboarding pages.

**apps/web/src/components/onboarding/org-onboarding-layout.tsx:**
- Create OrgOnboardingLayout component
- Props interface:
  - `children: React.ReactNode`
  - `title: string` - page title (e.g., "Connect HRIS")
  - `description: string` - page description
  - `currentStep: number` - current step index (0, 1, or 2)
  - `onBack?: () => void` - optional back button handler (if provided, show back button)
  - `onSkip: () => void` - skip button handler
  - `onNext: () => void` - next/complete button handler
  - `nextLabel?: string` - default "Next", can be "Complete Setup" for last step
  - `showSkip?: boolean` - default true, hide on governance page
  - `className?: string`
- Layout structure:
  1. Back button (top-left, ArrowLeft icon) - only if onBack provided
  2. SubStepper with current step highlighted
  3. Card container with:
     - Logo (Klayim symbol) centered
     - Title (h1, text-xl font-semibold)
     - Description (text-muted-foreground text-sm)
     - {children} slot for page-specific content
     - Footer with action buttons: "Skip for Now" (outline) | nextLabel (filled)
- Import SubStepper and ORG_ONBOARDING_STEPS from respective files
- Use existing Card, CardHeader, CardContent components
- Match existing onboarding page patterns (see connect-hris/index.tsx structure)
- Use Button component with proper variants (outline for skip, default for next)
  </action>
  <verify>
- `npx tsc --noEmit` passes
- OrgOnboardingLayout renders with sub-stepper, title, description, content slot, and action buttons
- Back button appears only when onBack provided
- Skip button hidden when showSkip=false
  </verify>
  <done>
OrgOnboardingLayout provides consistent structure for all org onboarding pages with sub-stepper, navigation, and action buttons
  </done>
</task>

</tasks>

<verification>
- All TypeScript compiles without errors: `npx tsc --noEmit`
- Components follow existing patterns (CVA for variants, data-slot attributes)
- SubStepper displays 3 steps with correct state indicators
- ProviderCard displays icon, name, description, and connect button
- InfoAccordion expands/collapses with checklist items
- OrgOnboardingLayout wraps content with consistent header, stepper, and footer
</verification>

<success_criteria>
- SubStepper component exists and shows completed/active/pending states
- ProviderCard component exists with connect action
- InfoAccordion component exists with expandable checklist
- OrgOnboardingLayout component exists and can wrap page content
- All components are properly typed with TypeScript
- Components use existing UI primitives (Card, Button, Accordion) as base
</success_criteria>

<output>
After completion, create `.planning/phases/phase-03/03-01-SUMMARY.md`
</output>
